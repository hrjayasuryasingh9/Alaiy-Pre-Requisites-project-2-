<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      .product-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        padding: 10px;
        padding-top: 70px;
      }
      .product-container .another-container {
        margin: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        width: 100%;
        max-width: 1200px;
        background-color: white;
        border-radius: 10px;
      }
      .product-image-container {
        width: 40%;
        min-width: 340px;
        height: 70vh;
        display: flex;
        justify-content: flex-end;
        align-items: center;
      }
      .product-image-container .product-image {
        width: 350px;
        height: 350px;
        background-image: url(https://row.hyperx.com/cdn/shop/products/hyperx_clutch_gladiate_6l366aa_main_1_900x.jpg?v=1675110393);
        background-position: center;
        background-size: cover;
        background-repeat: repeat;
      }

      .product-card {
        font-family: Arial, sans-serif;
        width: 50%;
        max-width: 700px;
        min-width: 380px;
        margin: 20px auto;
        padding: 20px;
        /* border: 1px solid #ddd; */
        border-radius: 12px;
        /* box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        background: #fff; */
      }

      @media (max-width: 760px) {
        .product-card {
          width: 100%;
        }
        .product-image-container {
          height: 50vh;
        }
      }
      .category {
        font-size: 12px;
        color: #888;
        text-transform: uppercase;
      }

      .title {
        font-size: 22px;
        font-weight: bold;
        margin: 8px 0;
      }

      .delivery {
        font-size: 14px;
        color: #555;
        margin-bottom: 20px;
      }

      .description-toggle h4 {
        font-size: 16px;
        margin-bottom: 6px;
      }

      .description {
        font-size: 14px;
        color: #444;
        line-height: 1.4;
      }

      .price-info {
        margin: 20px 0;
      }

      .regular-price {
        font-size: 18px;
        text-decoration: line-through;
        color: #888;
      }

      .member-price {
        font-size: 20px;
        font-weight: bold;
        color: #000;
      }

      .save-text {
        font-size: 12px;
        color: #666;
        display: block;
      }

      .quantity-selector {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 20px 0;
      }

      .qty-btn {
        width: 30px;
        height: 30px;
        font-size: 18px;
        border: 1px solid #aaa;
        background: none;
        cursor: pointer;
        border-radius: 5px;
      }

      .qty-value {
        font-size: 16px;
        min-width: 20px;
        text-align: center;
      }

      .wishlist-btn {
        margin-left: auto;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
      }

      .action-buttons {
        display: flex;
        gap: 10px;
      }

      .add-to-cart,
      .buy-now {
        flex: 1;
        padding: 10px;
        font-size: 16px;
        border-radius: 6px;
        cursor: pointer;
        border: none;
      }

      .add-to-cart {
        background: #3f5efb;
        color: #fff;
      }

      .buy-now {
        background: #000;
        color: #fff;
      }

      .recommended-products {
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        flex-wrap: wrap;
        width: 100%;
      }

      .products-list {
        width: 100%;
        max-width: 1200px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
        padding: 20px 10px;
      }
      .product {
        border-radius: 5px;
        flex-shrink: 0;
        width: 250px;
        height: 300px;
        background-color: #fff;
        overflow: hidden;
      }
      .product .product-image {
        position: relative;
        width: 100%;
        height: 80%;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
      }
      .product .product-image .add-cart {
        position: absolute;
        top: 3%;
        right: 3%;
        font-size: 20px;
        cursor: pointer;
      }
      .product p {
        padding: 0px 10px;
        font-size: 17px;
        font-weight: 400;
        width: 250px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
      }
      .product .Price-div {
        min-width: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
      }
      .product .Price-div span {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        background-color: #fff9a8;
        padding: 2px 5px;
        border-radius: 5px;
      }
      .product .Price-div span i {
        color: rgb(255, 225, 0);
      }
      .product .Price-div h2 {
        width: 250px;
        font-size: 17px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
      }

      .skeleton-card {
        background-color: #fff;
        border-radius: 10px;
        padding: 16px;
        margin: 12px;
        width: 250px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        gap: 12px;
        animation: pulse 1.2s ease-in-out infinite;
      }

      .skeleton {
        background: linear-gradient(
          -90deg,
          #eeeeee 0%,
          #dddddd 50%,
          #eeeeee 100%
        );
        background-size: 400% 400%;
        border-radius: 6px;
        animation: loading 1.5s ease-in-out infinite;
      }

      .skeleton-img {
        height: 180px;
        width: 100%;
        border-radius: 8px;
      }

      .skeleton-text {
        height: 18px;
      }
    </style>
  </head>
  <body>
    <header>
      <div><a href="index.html">ELECTRO ZONE</a></div>
      <ul>
        <li>
          <a href="cartpage.html"><i class="fa-solid fa-cart-shopping"></i></a>
        </li>
        <li>
          <a href="" id="userIcon"><i class="fa-solid fa-user"></i></a>
          <ul class="dropdown-menu" id="dropdownMenu">
            <li>
              <a href="#"
                ><i class="fa-solid fa-right-from-bracket"></i> Login</a
              >
            </li>
            <li>
              <a href="#"
                ><i class="fa-solid fa-right-from-bracket"></i> Logout</a
              >
            </li>
            <li>
              <a href="#"><i class="fa-solid fa-list-check"></i> My Orders</a>
            </li>
          </ul>
        </li>
      </ul>
    </header>
    <div class="product-container">
      <div class="another-container"></div>
    </div>
    <div class="recommended-products">
      <h1>You May Also Like</h1>
      <div class="products-list" id="product-list"></div>
    </div>
    <footer>
      <div class="footer-wrapper">
        <div class="footer-col brand">
          <a href="#" class="footer-logo">ELECTRO&nbsp;ZONE</a>
          <p class="footer-about">
            Your one‑stop destination for the latest electronics, gadgets and
            accessories. Explore innovation, grab the hottest deals, and stay
            ahead of the tech curve.
          </p>
        </div>

        <div class="footer-col">
          <h3>Shop</h3>
          <ul>
            <li><a href="#">Smartphones</a></li>
            <li><a href="#">Laptops &nbsp;/&nbsp; PCs</a></li>
            <li><a href="#">Smart&nbsp;Watches</a></li>
            <li><a href="#">Audio&nbsp;Gear</a></li>
            <li><a href="#">Gaming&nbsp;Accessories</a></li>
          </ul>
        </div>
        <div class="footer-col newsletter">
          <h3>Stay&nbsp;in&nbsp;the&nbsp;Loop</h3>
          <p>New drops, flash sales&nbsp;– straight to your inbox.</p>
          <form
            class="subscribe-form"
            onsubmit="event.preventDefault(); alert('Subscribed!');"
          >
            <input type="email" placeholder="Your email address" required />
            <button type="submit">
              <i class="fa-solid fa-paper-plane"></i>
            </button>
          </form>

          <div class="footer-contact">
            <p>
              <i class="fa-solid fa-location-dot"></i> Banglore,Karnataka, IN
            </p>
            <p><i class="fa-solid fa-phone"></i> +91 6565353525</p>
            <p><i class="fa-solid fa-envelope"></i> support@electrozone.com</p>
          </div>

          <div class="footer-socials">
            <a href="#"><i class="fa-brands fa-facebook-f"></i></a>
            <a href="#"><i class="fa-brands fa-instagram"></i></a>
            <a href="#"><i class="fa-brands fa-x-twitter"></i></a>
            <a href="#"><i class="fa-brands fa-linkedin-in"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© 2025 Electro Zone. All rights reserved.</p>
      </div>
    </footer>
    <script src="script.js"></script>
    <script>
      // Extract product ID from URL query parameters
      const params = new URLSearchParams(window.location.search);
      const productId = params.get("id");
      async function fetchAndRenderProduct(productId) {
        if (!productId) {
          document.querySelector(
            ".another-container"
          ).innerHTML = `<p style="color: red;">Product ID not found in URL</p>`;
          return;
        }

        try {
          const response = await fetch(
            `https://electrozone-cqf9.onrender.com/products/${productId}`
          );
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.detail || "Failed to fetch product");
          }

          const product = await response.json();
          console.log(product);

          fetchProductsByCategory(product.category, product.id);
          const container = document.querySelector(".another-container");
          container.innerHTML = `
              <div class="product-image-container">
                <div class="product-image" style="background-image: url(${
                  product.image
                });"></div>
              </div>
              <div class="product-card">
                <p class="category">${product.category.toUpperCase()} COLLECTION</p>
                <h2 class="title">${product.title}</h2>
                <p class="delivery">Delivery from 3 weeks</p>
      
                <div class="description-toggle">
                  <h4>DESCRIPTION</h4>
                  <p class="description">
                    ${product.description}
                    This premium piece is crafted with attention to detail, ensuring both comfort and durability.
                    Perfect for modern or traditional interiors, it effortlessly complements any setting.
                    Designed with user experience in mind, it offers ergonomic support and luxury appeal.
                    A timeless addition to elevate your living space.
                  </p>
                </div>
      
                <div class="price-info">
                  <h3>Stock : <span>20</span></h3>
                  <p class="member-price">$${product.price}</p>
                </div>
      
                <div class="quantity-selector">
                  <button class="qty-btn decrement">-</button>
                  <span class="qty-value">1</span>
                  <button class="qty-btn increment">+</button>
                </div>
      
                <div class="action-buttons">
                  <button class="add-to-cart checkout-btn">Add to cart</button>
                </div>
              </div>
            `;

          // ✅ Now attach event listeners after HTML is added
          let quantity = 1;
          const decrementBtn = document.querySelector(".decrement");
          const incrementBtn = document.querySelector(".increment");
          const qtyValue = document.querySelector(".qty-value");
          const checkoutBtn = document.querySelector(".checkout-btn");

          decrementBtn.addEventListener("click", () => {
            if (quantity > 1) {
              quantity--;
              qtyValue.textContent = quantity;
            }
          });

          incrementBtn.addEventListener("click", () => {
            quantity++;
            qtyValue.textContent = quantity;
          });

          checkoutBtn.addEventListener("click", () => {
            console.log(product.id, quantity);
            addToCart(product.id, quantity);
          });
        } catch (error) {
          console.error("Error:", error.message);
          document.querySelector(
            ".another-container"
          ).innerHTML = `<p style="color: red;">${error.message}</p>`;
        }
      }

      fetchAndRenderProduct(productId);

      const productList = document.getElementById("product-list");

      // Function to append skeletons
      function appendSkeletons(count) {
        for (let i = 0; i < count; i++) {
          productList.innerHTML += `
      <div class="skeleton-card">
        <div class="skeleton skeleton-img"></div>
        <div class="skeleton skeleton-text" style="width: 80%;"></div>
        <div class="skeleton skeleton-text" style="width: 50%;"></div>
      </div>
    `;
        }
      }

      async function fetchProductsByCategory(category, id) {
        productList.innerHTML = ""; // clear any existing content
        appendSkeletons(3);

        try {
          const response = await fetch(
            `https://electrozone-cqf9.onrender.com/products/category/${category}`
          );

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.detail || "Failed to fetch products");
          }

          const products = await response.json();

          // Clear skeletons before appending real products
          productList.innerHTML = "";

          products.forEach((item) => {
            if (item.id != id) {
              productList.innerHTML += `
        <div class="product">
          <div class="product-image" style="background-image: url(${item.image});" onclick="window.location.href='ProductviewPage.html?id=${item.id}'">
            <span class="add-cart"><i class="fa-solid fa-cart-plus"></i></span>
          </div>
          <p>${item.title}</p>
          <div class="Price-div">
            <h2>$${item.price}</h2>
            <span>${item.rating}.0<i class="fa-solid fa-star"></i></span>
          </div>
        </div>
      `;
            }
          });
        } catch (error) {
          productList.innerHTML = `<p style="color: red;">${error.message}</p>`;
          console.error("Error fetching products:", error.message);
        }
      }

      // Example usage:
      console.log(category_of_the_product);
    </script>
  </body>
</html>
